---
title: "PSTAT 131 Final Project - Sloth Species"
author: 'Mirabelle Le'
output: html_document
date: '2022-05-31'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction

The goal of this project is to generate a model that will predict a sloth's species, seeing if a sloth is two-toed or three-toed.

## All Things Sloths!

If you don't know what sloths are, they are an adorable species of animals well known for being slow and lethargic. These creatures spend a majority of their lives hanging on trees, sleeping, and remaining hidden from predators. The animals live solitary lives and travel from tree to tree using canopy vines. Located in places such as Brazil and Panama, this strange and wonderful animal needs healthy forests to survive. (Source: https://www.worldwildlife.org/stories/why-are-sloths-slow-and-six-other-sloth-facts)

There are two main species of sloth, identified by whether they have two or three claws on their front feet. The two species are quite similar in appearance, with roundish heads, sad-looking eyes, tiny ears, and stubby tails. Two-toed sloths are slightly bigger and tend to spend more time hanging upside-down than their three-toed cousins, who will often sit upright in the fork of a tree branch. Three-toed sloths have facial coloring that makes them look like they're always smiling. They also have two extra neck vertebrae that allow them to turn their heads almost all the way around! (Source: https://kids.nationalgeographic.com/animals/mammals/facts/sloth)

Here are a few cute pictures of sloths!

![A cute sloth!](/Users/mirabellele/Desktop/finalproject_131/sloth1.jpeg)

![A sloth hanging eating fruits!](/Users/mirabellele/Desktop/finalproject_131/sloth2.jpeg)

![A little sloth hanging on a branch!](/Users/mirabellele/Desktop/finalproject_131/sloth3.jpeg)

## Project Objectives

1. Clean the data and visualize the distribution of the features.
2. Create a classification model to predict if a sloth is two toed or three toed.


# Overview of Dataset

Let's begin by exploring the dataset and loading all of the data and necessary packages.

```{r, include=FALSE}
# Loading packages
library(tidymodels)
library(ISLR) 
library(ISLR2) 
library(ggplot2)
library(discrim)
library(poissonreg)
library(corrr)
library(klaR) # for naive bayes
tidymodels_prefer()
library(rpart.plot)
library(vip)
library(janitor)
library(randomForest)
library(xgboost)
library(ranger)
```


```{r}
# Loading the data
sloths <- read.csv("/Users/mirabellele/Desktop/finalproject_131/sloth_data.csv") 
head(sloths)
```

In this data set, our dataset contains 5000 observations and 7 predictors. The dataset includes information on the sizes of sloths, with each row being a different observed sloth. The variables include the claw length, the endangered category for the sloth, what species the sloth is, what subspecies the sloth is, its size, tail length, and weight. In addition, there is a column for the index of each sloth beginning at 0 and ending at 4999 (which I removed later on).

The link to the dataset can be found here: https://www.kaggle.com/datasets/bertiemackie/sloth-species . 

### Description of Each Attribute

* `x` : Index for each sloth
* `claw_length_cm` : The claw length of a sloth in centimeters
* `endangered` : The endangered category for the sub species
* `size_cm` : The size of the sloth (head & body) in cm
* `specie` : The species of sloth, two or three toed
* `sub_specie` : The sub specie of sloth
* `tail_length_cm` : The length of the sloths tail in cm
* `weight_kg` : The weight of the sloth in kg

# Data Cleaning

```{r}
# cleaning and deselecting variables
sloths <- sloths %>% 
  clean_names() %>%
  select(-x) 
```

I ended up removing the `x` column that contains the index for each sloth since I thought it was misleading since it started at 0 and ended at 4999 I believed it was unnecessary to include in my data. 

```{r}
# Factoring variables
sloths$endangered <- factor(sloths$endangered)
sloths$specie <- factor(sloths$specie)
sloths$sub_specie <- factor(sloths$sub_specie)
```

I made `endangered`, `specie`, and `sub_specie` into factors to categorize the data and stored it as levels. I believe that it would be useful in data analysis for statistical modeling.

### Data Splitting

The data was split in a 80% training, 20% testing split. I also decided to use stratified sampling.

The data split was conducted prior to the EDA as I did not want to know anything about my testing data set before I tested my model on those observations.

```{r}
set.seed(2424)

sloths_split <- initial_split(sloths, prop = 0.80,
                                strata = specie)
sloths_train <- training(sloths_split) # split sloths data into training & testing set
sloths_test <- testing(sloths_split)
```

The training data contains 3999 observations and the testing data contains 1001 observations.


# Exploratory Data Analysis (EDA)

### Let's explore the different variables and visualize the different distributions of the features.

```{r}
sloths %>% 
  ggplot(aes(x = claw_length_cm)) +
  geom_histogram(bins = 60) +
  theme_bw() +
  labs(
    title = "Claw Lengths of Sloths",
    x = "Claw Length (cm)",
    y = "Count"
  ) 
```

From the graph above, we can observe that the distribution of the sloth claw lengths closely follow a normal distribution.


```{r}
sloths %>% 
  ggplot(aes(x = tail_length_cm)) +
  geom_histogram(bins = 60) +
  theme_bw() +
  labs(
    title = "Tail Lengths of Sloths",
    x = "Tail Length (cm)",
    y = "Count"
  ) 
```

From the above graph, we can observe that the tail length of sloths in this dataset do not follow a normal distribution. It somewhat resembles a bimodel distribution. 

```{r}
sloths %>% 
  ggplot(aes(x = weight_kg)) +
  geom_histogram(bins = 60) +
  theme_bw() +
  labs(
    title = "Weight of Sloths",
    x = "Weight (kg)",
    y = "Count"
  ) 
```

From the graph above, we can observe that the distribution of the weights of the sloths closely follow a normal distribution.

```{r}
ggplot(sloths, aes(endangered)) +
  geom_bar() +
  labs(
    title = "Different Endangered Statuses of Sloths",
    x = "Endangered Status",
    y = "Count"
  ) +
  coord_flip()
```

Here, we can see the different endangered statuses of sloths. We can see that a large majority of the observed sloths fall under the least concern status, which is good! There are a good amount of sloths that also fall under the vulnerable category, and a small amount of sloths fall under the critically endangered category.

```{r}
ggplot(sloths, aes(x=size_cm, y=weight_kg)) + 
    geom_point() 
```

```{r}
ggplot(sloths, aes(x=size_cm, y=tail_length_cm)) + 
    geom_point() 
```

From the two above graphs, we find something very interesting! We can see that there are two clusters of data in both graphs when looking specifically at the different sizes of the sloths. 

